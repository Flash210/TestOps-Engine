# ============================================
# Smoke Tests - Quick Validation
# ============================================
# Fast smoke tests that run on every commit
# Only critical paths to provide quick feedback

name: Smoke Tests

# ============================================
# TRIGGER: On Every Push
# ============================================
on:
  push:
    branches: [ '**' ]  # All branches
  pull_request:
    branches: [ '**' ]
  workflow_dispatch:

# ============================================
# JOBS
# ============================================
jobs:
  smoke-tests:
    name: ðŸ’¨ Quick Smoke Tests
    runs-on: ubuntu-latest
    
    # Set timeout to prevent hanging tests
    timeout-minutes: 15
    
    steps:
      - name: ðŸ“¥ Checkout Repository
        uses: actions/checkout@v4
      
      - name: ðŸŸ¢ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18.x'
          cache: 'npm'
      
      - name: ðŸ“¦ Install Dependencies
        run: npm ci
      
      - name: ðŸŽ­ Install Playwright Browsers
        run: npx playwright install --with-deps chromium
      
      # Run only smoke tests using tags
      - name: ðŸ’¨ Run Smoke Tests
        run: npx cucumber-js --tags "@smoke"
        continue-on-error: false  # Fail fast on smoke test failures
      
      - name: ðŸ“Š Upload Results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: smoke-test-results
          path: test-results/
          retention-days: 7

# ============================================
# WHY SMOKE TESTS?
# ============================================
# - Fast feedback (< 15 minutes)
# - Catches critical issues early
# - Runs on all branches/commits
# - Prevents broken code from merging
